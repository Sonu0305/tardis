<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-53HJHD1BWS"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-53HJHD1BWS');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>How to Generate a Last Interaction Velocity (LIV) Plot &mdash; tardis</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../../_static/nbsphinx-code-cells.css" />

  
    <link rel="shortcut icon" href="../../_static/tardis_logo.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Convergence Plots" href="tutorial_convergence_plot.html" />
    <link rel="prev" title="How to Generate a Spectral element DEComposition (SDEC) Plot" href="how_to_sdec_plot.html" />
    <link href="../../_static/tardis.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            tardis
          </a>
              <div class="version">
                latest
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quickstart for TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how_to_guides.html">How-To Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/modules.html">API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Input/Output</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../io/hdf/index.html">Hierarchical Data Format (HDF5)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/configuration/index.html">Configuration (Required Input)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/model/index.html">Reading Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/optional/index.html">Optional Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/output/index.html">Additional Outputs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Analysing Tardis Outputs</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Visualization Tools &amp; Widgets</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="index.html#tardis-visualization-tools">TARDIS Visualization Tools</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="how_to_sdec_plot.html">How to Generate a Spectral element DEComposition (SDEC) Plot</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">How to Generate a Last Interaction Velocity (LIV) Plot</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Static-Plot-(in-matplotlib)">Static Plot (in matplotlib)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Interactive-Plot-(in-plotly)">Interactive Plot (in plotly)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Using-simulation-saved-as-HDF">Using simulation saved as HDF</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="tutorial_convergence_plot.html">Convergence Plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="tutorial_montecarlo_packet_visualization.html">Montecarlo Packet Visualization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#tardis-widgets-graphical-user-interfaces">TARDIS Widgets (Graphical User Interfaces)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../spectrum/index.html">Analyzing TARDIS Spectra</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics Walkthrough</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../physics/intro/index.html">Physics Walkthrough Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics/setup/index.html">Setting Up the Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics/montecarlo/index.html">Monte Carlo Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics/update_and_conv/update_and_conv.html">Updating Plasma and Convergence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics/spectrum/index.html">Spectrum Generation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../physics/tardisgamma/index.html">TARDIS gamma <span class="math notranslate nohighlight">\(\gamma\)</span></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to TARDIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/CONTRIBUTING.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/development/index.html">Developer Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/tools/index.html">Developer Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/CHANGELOG.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/in_progress/index.html">Features In-Progress</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../resources/credits.html">Credits &amp; Publication Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/research_done_using_TARDIS/research_papers.html">Papers Using TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/code_comparison/index.html">Code Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/zreferences.html">References and Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">tardis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Visualization Tools &amp; Widgets</a></li>
      <li class="breadcrumb-item active">How to Generate a Last Interaction Velocity (LIV) Plot</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/analysing_tardis_outputs/visualization/how_to_liv_plot.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <style>
    /* strip stderr */
    div.nboutput.container div.output_area.stderr {
        background: #fdd;
        display: none;
    }

    .launch-btn {
        background-color: #2980B9;
        border: none;
        border-radius: 4px;
        color: #fcfcfc;
        font-family: inherit;
        text-decoration: none;
        padding: 3px 8px;
        letter-spacing: 0.03em;
        display: inline-block;
        line-height: 1.5em;
    }

    .launch-btn:hover {
        background-color: #1b6391;
        color: #fcfcfc;
    }

    .launch-btn:visited {
        color: #fcfcfc;
    }

    .note-p {
        margin-bottom: 0.4em;
        line-height: 2em;
    }
</style>

<div class="admonition note">
<p class="note-p">You can interact with this notebook online: <a href="https://mybinder.org/v2/gh/tardis-sn/tardis/HEAD?filepath=docs/analysing_tardis_outputs/visualization/how_to_liv_plot.ipynb" class="launch-btn" target="_blank" rel="noopener noreferrer">Launch notebook</a></p>
</div><section id="How-to-Generate-a-Last-Interaction-Velocity-(LIV)-Plot">
<h1>How to Generate a Last Interaction Velocity (LIV) Plot<a class="headerlink" href="#How-to-Generate-a-Last-Interaction-Velocity-(LIV)-Plot" title="Link to this heading">¶</a></h1>
<p>The Last Interaction Velocity Plot tracks and display the velocities at which different elements (or species) last interacted with packets in the simulation.</p>
<p>First, create and run a simulation for which you want to generate this plot:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tardis</span> <span class="kn">import</span> <span class="n">run_tardis</span>
<span class="kn">from</span> <span class="nn">tardis.io.atom_data</span> <span class="kn">import</span> <span class="n">download_atom_data</span>

<span class="c1"># We download the atomic data needed to run the simulation</span>
<span class="n">download_atom_data</span><span class="p">(</span><span class="s1">&#39;kurucz_cd23_chianti_H_He&#39;</span><span class="p">)</span>

<span class="n">sim</span> <span class="o">=</span> <span class="n">run_tardis</span><span class="p">(</span><span class="s2">&quot;tardis_example.yml&quot;</span><span class="p">,</span> <span class="n">virtual_packet_logging</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">ModuleNotFoundError</span>                       Traceback (most recent call last)
Cell <span class="ansi-green-fg">In[1], line 1</span>
<span class="ansi-green-fg">----&gt; 1</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-bold" style="color: rgb(0,0,255)">tardis</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-bold" style="color: rgb(0,135,0)">import</span> run_tardis
<span class="ansi-green-intense-fg ansi-bold">      2</span> <span class="ansi-bold" style="color: rgb(0,135,0)">from</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-bold" style="color: rgb(0,0,255)">tardis</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">io</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">atom_data</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-bold" style="color: rgb(0,135,0)">import</span> download_atom_data
<span class="ansi-green-intense-fg ansi-bold">      4</span> <span style="color: rgb(95,135,135)"># We download the atomic data needed to run the simulation</span>

File <span class="ansi-green-fg">/opt/conda/envs/tardis/lib/python3.9/site-packages/tardis/__init__.py:26</span>
<span class="ansi-green-intense-fg ansi-bold">     23</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-bold" style="color: rgb(0,0,255)">os</span>
<span class="ansi-green-intense-fg ansi-bold">     24</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-bold" style="color: rgb(0,0,255)">urllib</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">parse</span>
<span class="ansi-green-fg">---&gt; 26</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-bold" style="color: rgb(0,0,255)">gi</span>
<span class="ansi-green-intense-fg ansi-bold">     27</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-bold" style="color: rgb(0,0,255)">caldav</span>
<span class="ansi-green-intense-fg ansi-bold">     28</span> <span class="ansi-bold" style="color: rgb(0,135,0)">import</span><span style="color: rgb(188,188,188)"> </span><span class="ansi-bold" style="color: rgb(0,0,255)">dateutil</span><span class="ansi-bold" style="color: rgb(0,0,255)">.</span><span class="ansi-bold" style="color: rgb(0,0,255)">tz</span>

<span class="ansi-red-fg">ModuleNotFoundError</span>: No module named &#39;gi&#39;
</pre></div></div>
</div>
<div class="admonition note">
<p class="admonition-title fa fa-exclamation-circle">Note</p>
<p>The virtual packet logging capability must be active in order to produce the Last Interaction Velocity Plot for virtual packets population. Thus, make sure to set <code class="docutils literal notranslate"><span class="pre">virtual_packet_logging:</span> <span class="pre">True</span></code> in your configuration file if you want to generate the Last Interaction Velocity Plot with virtual packets. It should be added under the <code class="docutils literal notranslate"><span class="pre">virtual</span></code> property of the <code class="docutils literal notranslate"><span class="pre">spectrum</span></code> property, as described in the <a class="reference external" href="https://tardis-sn.github.io/tardis/io/configuration/components/spectrum.html">configuration
schema</a>.</p>
</div>
<p>Now, import the plotting interface for Last Interaction Velocity Plot, i.e. the <code class="docutils literal notranslate"><span class="pre">LIVPlotter</span></code> class.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tardis.visualization.tools.liv_plot</span> <span class="kn">import</span> <span class="n">LIVPlotter</span>
</pre></div>
</div>
</div>
<p>And create a plotter object to process the data of simulation object <code class="docutils literal notranslate"><span class="pre">sim</span></code> for generating the Last Interaction Velocity plot.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span> <span class="o">=</span> <span class="n">LIVPlotter</span><span class="o">.</span><span class="n">from_simulation</span><span class="p">(</span><span class="n">sim</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Static-Plot-(in-matplotlib)">
<h2>Static Plot (in matplotlib)<a class="headerlink" href="#Static-Plot-(in-matplotlib)" title="Link to this heading">¶</a></h2>
<p>You can now call the <code class="docutils literal notranslate"><span class="pre">generate_plot_mpl()</span></code> method on your plotter object to create a highly informative and visually appealing Last Interaction Velocity plot using matplotlib.</p>
<section id="Virtual-packets-mode">
<h3>Virtual packets mode<a class="headerlink" href="#Virtual-packets-mode" title="Link to this heading">¶</a></h3>
<p>By default, a Last Interaction Velocity plot is produced for the virtual packet population of the simulation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_mpl</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="Real-packets-mode">
<h3>Real packets mode<a class="headerlink" href="#Real-packets-mode" title="Link to this heading">¶</a></h3>
<p>You can produce a Last Interaction Velocity plot for the real packet population of the simulation by setting <code class="docutils literal notranslate"><span class="pre">packets_mode=&quot;real&quot;</span></code> which is <code class="docutils literal notranslate"><span class="pre">&quot;virtual&quot;</span></code> by default.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_mpl</span><span class="p">(</span><span class="n">packets_mode</span><span class="o">=</span><span class="s2">&quot;real&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Plotting-a-specific-wavelength-range">
<h3>Plotting a specific wavelength range<a class="headerlink" href="#Plotting-a-specific-wavelength-range" title="Link to this heading">¶</a></h3>
<p>You can also restrict the wavelength range of escaped packets that you want to plot by specifying <code class="docutils literal notranslate"><span class="pre">packet_wvl_range</span></code>. It should be a quantity in Angstroms, containing two values - lower lambda and upper lambda i.e. <code class="docutils literal notranslate"><span class="pre">[lower_lambda,</span> <span class="pre">upper_lambda]</span> <span class="pre">*</span> <span class="pre">u.AA</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_mpl</span><span class="p">(</span><span class="n">packet_wvl_range</span><span class="o">=</span><span class="p">[</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">9000</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Plotting-only-the-top-contributing-elements">
<h3>Plotting only the top contributing elements<a class="headerlink" href="#Plotting-only-the-top-contributing-elements" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">nelements</span></code> option allows you to plot the top contributing elements to the spectrum. Only the top elements are shown in the plot. Please note this works only for elements and not for ions.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_mpl</span><span class="p">(</span><span class="n">nelements</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Choosing-what-elements/ions-to-plot">
<h3>Choosing what elements/ions to plot<a class="headerlink" href="#Choosing-what-elements/ions-to-plot" title="Link to this heading">¶</a></h3>
<p>You can pass a <code class="docutils literal notranslate"><span class="pre">species_list</span></code> for the species you want plotted in the Last Interaction Velocity Plot. Valid options include elements (e.g., Si), ions (specified in Roman numeral format, e.g., Si II), a range of ions (e.g., Si I-III), or any combination of these.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_mpl</span><span class="p">(</span><span class="n">species_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Si I-III&quot;</span><span class="p">,</span> <span class="s2">&quot;O&quot;</span><span class="p">,</span> <span class="s2">&quot;Ca&quot;</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>When using both the <code class="docutils literal notranslate"><span class="pre">nelements</span></code> and the <code class="docutils literal notranslate"><span class="pre">species_list</span></code> options, <code class="docutils literal notranslate"><span class="pre">species_list</span></code> takes precedence.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_mpl</span><span class="p">(</span><span class="n">species_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Si I-III&quot;</span><span class="p">,</span> <span class="s2">&quot;Ca&quot;</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">],</span> <span class="n">nelements</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Plotting-a-specific-number-of-bins">
<h3>Plotting a specific number of bins<a class="headerlink" href="#Plotting-a-specific-number-of-bins" title="Link to this heading">¶</a></h3>
<p>You can regroup the bins with broader widths within the same velocity range using <code class="docutils literal notranslate"><span class="pre">num_bins</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_mpl</span><span class="p">(</span><span class="n">species_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Si I-III&quot;</span><span class="p">,</span> <span class="s2">&quot;O&quot;</span><span class="p">,</span> <span class="s2">&quot;Ca&quot;</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">],</span> <span class="n">num_bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Plotting-on-the-Log-Scale">
<h3>Plotting on the Log Scale<a class="headerlink" href="#Plotting-on-the-Log-Scale" title="Link to this heading">¶</a></h3>
<p>You can plot on the log scale on x-axis using <code class="docutils literal notranslate"><span class="pre">xlog_scale=True</span></code> and on y-axis using <code class="docutils literal notranslate"><span class="pre">ylog_scale=True</span></code> by default both are set to <code class="docutils literal notranslate"><span class="pre">False</span></code> which plots on a linear scale.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_mpl</span><span class="p">(</span><span class="n">species_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Si I-III&quot;</span><span class="p">,</span> <span class="s2">&quot;O&quot;</span><span class="p">,</span> <span class="s2">&quot;Ca&quot;</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">],</span> <span class="n">xlog_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ylog_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Plotting-a-specific-velocity-range">
<h3>Plotting a specific velocity range<a class="headerlink" href="#Plotting-a-specific-velocity-range" title="Link to this heading">¶</a></h3>
<p>You can restrict the range of bins to plot in the Last Interaction Velocity Plot by specifying a valid <code class="docutils literal notranslate"><span class="pre">velocity_range</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_mpl</span><span class="p">(</span><span class="n">species_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Si I-III&quot;</span><span class="p">,</span> <span class="s2">&quot;O&quot;</span><span class="p">,</span> <span class="s2">&quot;Ca&quot;</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">],</span> <span class="n">velocity_range</span><span class="o">=</span><span class="p">(</span><span class="mi">12500</span><span class="p">,</span> <span class="mi">15050</span><span class="p">))</span>
</pre></div>
</div>
</div>
</section>
<section id="Additional-plotting-options">
<h3>Additional plotting options<a class="headerlink" href="#Additional-plotting-options" title="Link to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To list all available options (or parameters) with their description</span>
<span class="n">help</span><span class="p">(</span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_mpl</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">generate_plot_mpl</span></code> method also has options specific to the matplotlib API, thereby providing you with more control over how your last interaction velocity looks. Possible cases where you may use them are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ax</span></code>: To plot on an Axis of a plot you’re already working with, e.g. for subplots.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">figsize</span></code>: To resize the plot as per your requirements.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cmapname</span></code>: To use a colormap of your preference, instead of “jet”.</p></li>
</ul>
</section>
</section>
<section id="Interactive-Plot-(in-plotly)">
<h2>Interactive Plot (in plotly)<a class="headerlink" href="#Interactive-Plot-(in-plotly)" title="Link to this heading">¶</a></h2>
<p>If you’re using the Last Interaction Velocity plot for exploration, consider creating an interactive version with <code class="docutils literal notranslate"><span class="pre">generate_plot_ply()</span></code>. This allows you to zoom, pan, inspect data values by hovering, resize the scale, and more conveniently.</p>
<p><strong>This method takes the same arguments as ``generate_plot_mpl`` except for a few specific to the Plotly library.</strong> You can produce all the plots shown above in Plotly by passing the same arguments.</p>
<section id="id1">
<h3>Virtual packets mode<a class="headerlink" href="#id1" title="Link to this heading">¶</a></h3>
<p>By default, a Last Interaction Velocity plot is produced for the virtual packet population of the simulation.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_ply</span><span class="p">()</span>
</pre></div>
</div>
</div>
</section>
<section id="id2">
<h3>Real packets mode<a class="headerlink" href="#id2" title="Link to this heading">¶</a></h3>
<p>You can produce a Last Interaction Velocity plot for the real packet population of the simulation by setting <code class="docutils literal notranslate"><span class="pre">packets_mode=&quot;real&quot;</span></code> which is <code class="docutils literal notranslate"><span class="pre">&quot;virtual&quot;</span></code> by default.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_ply</span><span class="p">(</span><span class="n">packets_mode</span><span class="o">=</span><span class="s2">&quot;real&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="id3">
<h3>Plotting a specific wavelength range<a class="headerlink" href="#id3" title="Link to this heading">¶</a></h3>
<p>You can also restrict the wavelength range of escaped packets that you want to plot by specifying <code class="docutils literal notranslate"><span class="pre">packet_wvl_range</span></code>. It should be a quantity in Angstroms, containing two values - lower lambda and upper lambda i.e. <code class="docutils literal notranslate"><span class="pre">[lower_lambda,</span> <span class="pre">upper_lambda]</span> <span class="pre">*</span> <span class="pre">u.AA</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_ply</span><span class="p">(</span><span class="n">packet_wvl_range</span><span class="o">=</span><span class="p">[</span><span class="mi">3000</span><span class="p">,</span> <span class="mi">9000</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="id4">
<h3>Plotting only the top contributing elements<a class="headerlink" href="#id4" title="Link to this heading">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">nelements</span></code> option allows you to plot the top contributing elements to the spectrum. Only the top elements are shown in the plot. Please note this works only for elements and not for ions.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_ply</span><span class="p">(</span><span class="n">nelements</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="id5">
<h3>Choosing what elements/ions to plot<a class="headerlink" href="#id5" title="Link to this heading">¶</a></h3>
<p>You can pass a <code class="docutils literal notranslate"><span class="pre">species_list</span></code> for the species you want plotted in the Last Interaction Velocity Plot. Valid options include elements (e.g., Si), ions (specified in Roman numeral format, e.g., Si II), a range of ions (e.g., Si I-III), or any combination of these.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_ply</span><span class="p">(</span><span class="n">species_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Si I-III&quot;</span><span class="p">,</span> <span class="s2">&quot;Ca&quot;</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>When using both the <code class="docutils literal notranslate"><span class="pre">nelements</span></code> and the <code class="docutils literal notranslate"><span class="pre">species_list</span></code> options, <code class="docutils literal notranslate"><span class="pre">species_list</span></code> takes precedence.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_ply</span><span class="p">(</span><span class="n">species_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Si I-III&quot;</span><span class="p">,</span> <span class="s2">&quot;Ca&quot;</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">],</span> <span class="n">nelements</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="id6">
<h3>Plotting a specific number of bins<a class="headerlink" href="#id6" title="Link to this heading">¶</a></h3>
<p>You can regroup the bins with broader widths within the same velocity range using <code class="docutils literal notranslate"><span class="pre">num_bins</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_ply</span><span class="p">(</span><span class="n">species_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Si I-III&quot;</span><span class="p">,</span> <span class="s2">&quot;Ca&quot;</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">],</span> <span class="n">num_bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="id7">
<h3>Plotting on the Log Scale<a class="headerlink" href="#id7" title="Link to this heading">¶</a></h3>
<p>You can plot on the log scale on x-axis using <code class="docutils literal notranslate"><span class="pre">xlog_scale=True</span></code> and on y-axis using <code class="docutils literal notranslate"><span class="pre">ylog_scale=True</span></code> by default both are set to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_ply</span><span class="p">(</span><span class="n">species_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Si I-III&quot;</span><span class="p">,</span> <span class="s2">&quot;Ca&quot;</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">],</span> <span class="n">xlog_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ylog_scale</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="id8">
<h3>Plotting a specific velocity range<a class="headerlink" href="#id8" title="Link to this heading">¶</a></h3>
<p>You can restrict the range of bins to plot in the Last Interaction Velocity Plot by specifying a valid <code class="docutils literal notranslate"><span class="pre">velocity_range</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_ply</span><span class="p">(</span><span class="n">species_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Si I-III&quot;</span><span class="p">,</span> <span class="s2">&quot;Ca&quot;</span><span class="p">,</span> <span class="s2">&quot;S&quot;</span><span class="p">],</span> <span class="n">velocity_range</span><span class="o">=</span><span class="p">(</span><span class="mi">12500</span><span class="p">,</span> <span class="mi">15050</span><span class="p">))</span>
</pre></div>
</div>
</div>
</section>
<section id="id9">
<h3>Additional plotting options<a class="headerlink" href="#id9" title="Link to this heading">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># To list all available options (or parameters) with their description</span>
<span class="n">help</span><span class="p">(</span><span class="n">plotter</span><span class="o">.</span><span class="n">generate_plot_ply</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">generate_plot_ply</span></code> method also has options specific to the plotly API, thereby providing you with more control over how your last interaction velocity plot looks. Possible cases where you may use them are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fig</span></code>: To plot the last interaction velocity plot on a figure you are already using e.g. for subplots.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">graph_height</span></code>: To specify the height of the graph as needed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cmapname</span></code>: To use a colormap of your preference instead of “jet”.</p></li>
</ul>
</section>
</section>
<section id="Using-simulation-saved-as-HDF">
<h2>Using simulation saved as HDF<a class="headerlink" href="#Using-simulation-saved-as-HDF" title="Link to this heading">¶</a></h2>
<p>Other than producing the Last Interaction Velocity Plot for simulation objects in runtime, you can also produce it for saved TARDIS simulations.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># hdf_plotter = LIVPlotter.from_hdf(&quot;demo.h5&quot;) ## Files is too large - just as an example</span>
</pre></div>
</div>
</div>
<p>This <code class="docutils literal notranslate"><span class="pre">hdf_plotter</span></code> object is similar to the <code class="docutils literal notranslate"><span class="pre">plotter</span></code> object we used above, <strong>so you can use each plotting method demonstrated above with this too.</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Static plot with virtual packets mode</span>
<span class="c1"># hdf_plotter.generate_plot_mpl()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Static plot with real packets mode</span>
<span class="c1">#hdf_plotter.generate_plot_mpl(packets_mode=&quot;real&quot;)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Interactive plot with virtual packets mode and specific list of species</span>
<span class="c1"># hdf_plotter.generate_plot_ply(species_list=[&quot;Si I-III&quot;, &quot;Ca&quot;, &quot;O&quot;, &quot;S&quot;])</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Interactive plot with virtual packets mode and regrouped bins</span>
<span class="c1"># hdf_plotter.generate_plot_ply(num_bins=10)</span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="how_to_sdec_plot.html" class="btn btn-neutral float-left" title="How to Generate a Spectral element DEComposition (SDEC) Plot" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tutorial_convergence_plot.html" class="btn btn-neutral float-right" title="Convergence Plots" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2025, TARDIS Collaboration.
      <span class="lastupdated">Last updated on 18 Mar 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>