<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-53HJHD1BWS"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-53HJHD1BWS');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sources of Opacity &mdash; tardis</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />
      <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />

  
    <link rel="shortcut icon" href="../../_static/tardis_logo.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../../_static/doctools.js?v=9a2dae69"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Contribution Guidelines" href="../../contributing/CONTRIBUTING.html" />
    <link rel="prev" title="Packet Initialization" href="packetinitialization.html" />
    <link href="../../_static/tardis.css" rel="stylesheet" type="text/css">

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            tardis
          </a>
              <div class="version">
                latest
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quickstart.html">Quickstart for TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../how_to_guides.html">How-To Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq.html">Frequently Asked Questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api/modules.html">API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Input/Output</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../io/hdf/index.html">Hierarchical Data Format (HDF5)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/configuration/index.html">Configuration (Required Input)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/model/index.html">Reading Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/optional/index.html">Optional Inputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/visualization/index.html">Visualization Tools &amp; Widgets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../io/output/index.html">Additional Outputs</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Physics Walkthrough</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">Physics Walkthrough Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup/index.html">Setting Up the Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../montecarlo/index.html">Monte Carlo Iteration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../update_and_conv/update_and_conv.html">Updating Plasma and Convergence</a></li>
<li class="toctree-l1"><a class="reference internal" href="../spectrum/index.html">Spectrum Generation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">TARDIS gamma <span class="math notranslate nohighlight">\(\gamma\)</span></a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="packetinitialization.html">Packet Initialization</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Sources of Opacity</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pair-creation">Pair Creation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compton-scattering">Compton Scattering</a></li>
<li class="toctree-l3"><a class="reference internal" href="#photoabsorption">Photoabsorption</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Contributing to TARDIS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/CONTRIBUTING.html">Contribution Guidelines</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/development/index.html">Developer Workflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/tools/index.html">Developer Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/CHANGELOG.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/in_progress/index.html">Features In-Progress</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Other Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../resources/credits.html">Credits &amp; Publication Policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/research_done_using_TARDIS/research_papers.html">Papers Using TARDIS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/code_comparison/index.html">Code Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/zreferences.html">References and Glossary</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">tardis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">TARDIS gamma <span class="math notranslate nohighlight">\(\gamma\)</span></a></li>
      <li class="breadcrumb-item active">Sources of Opacity</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/physics/tardisgamma/opacities.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="sources-of-opacity">
<h1>Sources of Opacity<a class="headerlink" href="#sources-of-opacity" title="Link to this heading">¶</a></h1>
<p>Within the ejecta there are several sources of opacity for the <span class="math notranslate nohighlight">\(\gamma\)</span>-rays that we need to take into account.</p>
<section id="pair-creation">
<h2>Pair Creation<a class="headerlink" href="#pair-creation" title="Link to this heading">¶</a></h2>
<p>This form of opacity is dominant when the energy of the <span class="math notranslate nohighlight">\(\gamma\)</span>-ray is greater than or equal to <span class="math notranslate nohighlight">\(2m_e c^2\)</span>.
It occurs when a <span class="math notranslate nohighlight">\(\gamma\)</span>-ray passes a nucleus and creates an electron-positron pair. The positron forms a bound-state with an electron called positronium which decay into two photons at 0.511 MeV or three photons.
The photon packet keeps its energy but is sent into a new direction.
The pair-production coefficients are:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\alpha_{pp}(1.5 &lt; h\nu &lt; 1.022) = \rho [ \frac{Z_{\text{Si}}^2}{m_{\text{Si}}} (1 - X_{\text{IGE}}) + \frac{Z_{\text{Fe}}^2}{m_{\text{Fe}}} X_{\text{IGE}}]1.0063(h\nu - 1.022) \times 10^{-27}\\ \alpha_{pp}(h\nu \geq 1.5) = \rho [ \frac{Z_{\text{Si}}^2}{m_{\text{Si}}} (1 - X_{\text{IGE}}) + \frac{Z_{\text{Fe}}^2}{m_{\text{Fe}}} X_{\text{IGE}}] [0.481 + 0.301(h\nu - 1.5)] \times 10^{-27}\end{aligned}\end{align} \]</div>
<p><span class="math notranslate nohighlight">\(\rho\)</span> is the mass density of the ejecta and <span class="math notranslate nohighlight">\(X_{\text{IGE}}\)</span> is the mass fraction of Fe-group elements.</p>
<figure class="align-default">
<img alt="../../_images/pair_production_coefficient.png" src="../../_images/pair_production_coefficient.png" />
</figure>
</section>
<section id="compton-scattering">
<h2>Compton Scattering<a class="headerlink" href="#compton-scattering" title="Link to this heading">¶</a></h2>
<p>Compton scattering is inelastic scattering that occurs when a high frequency photon collides with an electron. Unlike Thomson scattering, which is elastic, during the collision some of the energy from the photon is transferred to the electron and the scattered photon is lower energy than the incident photon.
This means that the scattered photon also has a lower frequency and a longer wavelength. In the simulation we assume that the electrons are moving significantly slower than the photons.
To find the energy of the scattered photon we use the equation we multiply the initial energy with the compton fraction <span class="math notranslate nohighlight">\(f_C\)</span></p>
<div class="math notranslate nohighlight">
\[f_C = \frac{1}{1 + x(1 - \cos{\theta})}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\theta\)</span> is the angle the photon is scattered at and <span class="math notranslate nohighlight">\(x = \frac{h \nu}{m_e c^2}\)</span></p>
<p>The partial cross section from 0 to <span class="math notranslate nohighlight">\(\theta\)</span> in terms of f is:</p>
<div class="math notranslate nohighlight">
\[\sigma(f) = \frac{3 \sigma_T}{8x} \frac{\left( x^2 - 2x - 2 \right) \ln(f)}{x^2} + \frac{f^2 - 1}{2f^2} +  \frac{f - 1}{x} [\frac{1}{x} + 2f + \frac{1}{xf}]\]</div>
<p>Where f can range from 1 to 1+2x and <span class="math notranslate nohighlight">\(\sigma_T\)</span> is the Thomson scattering cross section.</p>
<p>The scattering angle is given by:</p>
<div class="math notranslate nohighlight">
\[\theta_C = \cos^{-1}({1 - \frac{f-1}{x}})\]</div>
<p>The total integrated Compton scattering coeffcient is:</p>
<div class="math notranslate nohighlight">
\[\alpha_C = n_e \frac{3}{4} \sigma_T [\frac{1+x}{x^3} (\frac{2x(1 + x)}{1 + 2x} - \ln(1 + 2x)) + \frac{1}{2x} \ln(1 + 2x) - \frac{1 + 3x}{(1 + 2x)^2}]\]</div>
<p>Where <span class="math notranslate nohighlight">\(n_e\)</span> is the number density of electrons.</p>
<figure class="align-default">
<img alt="../../_images/compton_scattering_coefficient.png" src="../../_images/compton_scattering_coefficient.png" />
</figure>
<p>The direction vector is then rotated by <span class="math notranslate nohighlight">\(\theta\)</span> to get the new direction and the frequency is updated.</p>
</section>
<section id="photoabsorption">
<h2>Photoabsorption<a class="headerlink" href="#photoabsorption" title="Link to this heading">¶</a></h2>
<p>This occurs when the photon is completely absorbed by a material. We assume that the <span class="math notranslate nohighlight">\(\gamma\)</span>-ray deposits all of its energy when this occurs.
The coefficient is:</p>
<div class="math notranslate nohighlight">
\[\alpha_{pa}(\nu) = 1.16 \times 10^{-24} (h\nu)^{-3.13}  \frac{\rho}{m_{\text{Si}}} (1 - X_{\text{IGE}}) + 25.7 \times 10^{-24} (h\nu)^{-3}  \frac{\rho}{m_{\text{Fe}}} X_{\text{IGE}}\]</div>
<figure class="align-default">
<img alt="../../_images/photoabsorption_coefficient.png" src="../../_images/photoabsorption_coefficient.png" />
</figure>
<p>Each source of opacity is dominant in different energy ranges. We can see this when all three coefficients are plotted together:</p>
<figure class="align-default">
<img alt="../../_images/all_coeffs.png" src="../../_images/all_coeffs.png" />
</figure>
<p>We can also look at the fraction of the total absorption coefficient that each source of opacity takes up in different energy levels:</p>
<figure class="align-default">
<img alt="../../_images/coeff_fractions.png" src="../../_images/coeff_fractions.png" />
</figure>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="packetinitialization.html" class="btn btn-neutral float-left" title="Packet Initialization" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../contributing/CONTRIBUTING.html" class="btn btn-neutral float-right" title="Contribution Guidelines" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2013-2025, TARDIS Collaboration.
      <span class="lastupdated">Last updated on 21 Jan 2025.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>